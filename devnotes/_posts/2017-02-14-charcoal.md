---
layout: post
title: Charcoal
date: 2017-02-14 22:00:00 +0900
tags: [markdown, charcoal]
---

마크다운 에디터 이름을 정했다. **Charcoal**(목탄)으로 한다.

좀 더 에디터 개발에 필요한 정보를 조사했다.

## 다른 에디터 분석

여러가지 Wysiwyg 기능이 붙어있는 마크다운 에디터를 찾아보았다. 의외로 개발에 앞서 많은 힌트가 얻어졌다.

일단 대충 느낀 점만 언급한다. 나중에 개발동기를 깨끗하게 정리할 필요가 있지만, 지금은 프로토타입이 우선이이다.

### Typora

먼저 살펴보면서 파악된 부분은 다음과 같다.

- GFM에 가장 근접
- 웹뷰 베이스로 만들어져있다.
- content editible을 활용한다.
- codemirror로 코드블럭을 다루고 있다.
- 클립보드 복사 시 마크다운으로 복사하는 기능이 따로 있다. 기본복사는 HTML/Plain Text로 관리하는듯 하다.
- HTML은 지원하지 않는다.
- 비공개 소스
- 어떤 마크다운 파서를 쓰는지 조차 모른다.

그리고 [개발자 블로그](http://abnerlee.github.io/typora/2015/03/11/why-typora/)를 보면 Typora의 컨샙이 있는데 상당히 배울만한 듯 하다.
그리고 렌더러와 파서를 동일한곳에 제공해야 한다는것도 공감된다.

### ProseMirror

- CodeMirror제작자가 만들었다.
- 그럼에도 불구하고 신택스 하이라이트 지원이 빠져있다.(개발자 스스로 어렵다고 인정하고 있기에 시간이 걸릴듯하다.)
- 인디고고에서 소셜펀딩으로 제작이 시작되었다.
- 오픈소스
- 자체 파서를 쓰고 있다.

### Draft.js

- 페이스북에서 만들었다.
- 원칙적으로 마크다운 지원은 하지 않는다.
- 엔티티라는 개념덕분에 확장성은 높다. 하지만 안정적으로 사용가능할지는 미지수이다.

### [Slate](https://github.com/ianstormtaylor/slate)

- 역시 마크다운 에디터는 아니다.
- 플러그인으로 마크다운 신택스를 숏컷키처럼 활용하고 있다.

## Modeling Language

플로우차트와 같은 다이어그램까지 지원을 고려하고 있다.

대충 [Modeling Language](https://en.wikipedia.org/wiki/Modeling_language)에 대부분 정리되어 있는 듯하다. 물론 모두 대응할 필요는 없고 나중에 니즈를 읽어가며 하면 되겠다.

단지 마크다운에 신택스적으로 추가되어져야할 부분이 많다.

일단 초기에는 [Mermaid](https://github.com/knsv/mermaid)를 쓰는 걸로 충분할듯하다.

이쪽 부분에 있어선 실제 그룹으로 프로그래밍을 하는 유저의 히어링이 필요하다.

## 파서

파서는 이전 포스팅에 언급한 Wooorm/Remark를 사용한다. 성능은 다른 파서보다 조금 떠러질지 몰라도 파스된 코드를 깨끗하게 다루기쉬운 AST로 만들어주기 때문에 플러그인의 추가가 용이하다. 또한, 본 에디터의 경우 AST를 직접적으로 편집하기 때문에 최초 AST화를 위한 파스 이외에 프리뷰를 위한 파싱은 하지 않는다.

## 1차 마일스톤

먼저 기본적인 블럭 생성과 인라인 요소를 처리할 수 있는 기능 구현을 우선으로 한다.

개발은 일렉트론에서 실시한다.

### 블럭 종류

지원해야 할 블럭의 종류는 다음과 같다.

- 헤딩1~6
- 단락
- 인용블럭
- 코드펜스
- 테이블
- 레이텍 블록
- 리스트(오더드, 언오더드)

이 중 테이블, 레이텍블록 그리고 인용블럭과 리스트블럭안에 다른 블럭을 넣는건 다음 마일스톤으로 미룬다.

### 인라인 종류

- 굵게
- 기울임
- 취소선
- 코드
- 레이텍 인라인

이 중 레이텍 인라인은 미룬다.
